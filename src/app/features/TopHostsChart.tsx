import { useEffect, useState } from "react";
import { Dashboard } from "../../sdk/@types/Dashboard";
import DashboardService from "../../sdk/services/dashboard.service";
import Chart from "../components/Chart/Chart";
export interface TopHostsChartProps {
  token: string
}

export default function TopHostsChart ({token}:TopHostsChartProps) {
  const [dataList, setDataList] = useState<Dashboard.ChartAssets[]>()
  let severidades: string[] = []
  let dados: number[] = []

  useEffect(()=>{
    DashboardService
      .getTopAssets(token)
      .then(setDataList)
    },[token])
    
  
  dataList?.forEach((item:Dashboard.ChartAssets) => {
    severidades.push(item.host)
    dados.push(item.vuln_count)
})

  const options: Highcharts.Options = {
    title: {
        text: 'Vulnerabilidades por Severidade'
    },
    xAxis:{
      categories: severidades
    },
    yAxis:{
      title: {
        text: 'NÃºmero de Hosts'
      }
    },
    series: [
      
      {
        name: 'Severidade',
        type: 'bar',
        data: dados
    }]
  }
console.log(severidades, dados, options)
  // return null
  return <Chart options={options} />
}