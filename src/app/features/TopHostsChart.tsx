import { SeriesOptionsType } from "highcharts";
import { useEffect, useState } from "react";
import { Dashboard } from "../../sdk/@types/Dashboard";
import DashboardService from "../../sdk/services/dashboard.service";
import Chart from "../components/Chart/Chart";

export interface TopHostsChartProps {
  token: string
}

export default function TopHostsChart ({token}:TopHostsChartProps) {

  const [hostList, setHostList] = useState<SeriesOptionsType[]>()
  const [dataList, setDataList] = useState<Dashboard.ChartAssets[]>()

  useEffect(()=>{
    DashboardService
      .getTopAssets(token)
      .then(setDataList)
    },[token])
    
    // setHostList(dataList!.map(handleData))

    // function handleData (data:Dashboard.ChartAssets):SeriesOptionsType[] {
    //   return [{
    //     name: data.host,
    //     type: 'column',
    //     data: [data.vuln_count]
    //   }]
    // }

  const options: Highcharts.Options = {
    title: {
        text: 'Vulnerabilidades por Severidade'
    },
    xAxis:{
      title: {
        text: 'Hosts'
      }
    },
    yAxis:{
      title: {
        text: 'NÃºmero de Vulnerabilidades'
      }
    },
    series: hostList
    // series: [
      
    //   {
    //     name: 'Severidade',
    //     type: 'column',
    //     data: dataList
    // }]
}

  return <Chart options={options} />
}