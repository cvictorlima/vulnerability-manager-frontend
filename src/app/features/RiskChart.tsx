import { useEffect, useState } from "react"
import styled from "styled-components"
import CircleChart from "../components/CircleChart"
import { Dashboard } from "../../sdk/@types/Dashboard"
import DashboardService from "../../sdk/services/dashboard.service"

export interface RiskChartProps {
  token: string
}

export default function RiskChart ({token}:RiskChartProps) {
  const [data, setData] = useState<Dashboard.CardRisk>()

  useEffect(()=> {
    DashboardService
      .getRiskCard(token)
      .then(response=> {setData(response)
      })
  },[token])

  if (!data)
    return null

  return <Wrapper>
    <Section>
      <CircleChart 
        progress={data.risk_avg*10}
        size={80}
        strokeWidth={9}
        theme="default"
        value={data?.risk_avg}        
      />
      <h3>MÃ©dia de Risco</h3>
    </Section>
  </Wrapper>
}

const Wrapper = styled.div`
`

const Section = styled.div`
display: flex;
flex-direction: column;
align-items: center;
gap: 6px;

`