import Service from "../Service";


class VulnerabilityService extends Service {
  static getVulnerabilities () {
    return this.Http
      .get('/api/vulnerabilities/')
      .then 
  }

  static changeVulnerabilityStatus (
    vulnerabilityID: number, assetId: number, vulnStatus: 1 | 0
  ) {
    return this.Http
      .patch(`/api/vulnerability/<vuln_pk>/asset/<asset_pk>/update`, vulnStatus)
      .then(this.getData)
  }

  static getVulnerabilityByAsset (assetId: number) {
    return this.Http
      .get(`/api/vulnerabilities/?asset=${assetId}`)
      .then(this.getData)
  }

  static getVulnerabilityBySeverity (severityLevel: 1 | 2 | 3 | 4) {
    return this.Http
      .get(`/api/vulnerabilities/?severity=${severityLevel}`)
      .then(this.getData)
  }
}

export default VulnerabilityService