import { Asset } from "../@types/Asset";
import Service from "../Service";


class AssetService extends Service {
  static getAllAssets (token: string) {
    return this.Http
      .get<Asset.Summary>('/api/assets/', { headers: { Authorization: token }})
      .then(this.getData)
  }

  static getAssetDetail (assetID: number, token: string) {
    return this.Http
      .get<Asset.Detailed>(`api/assets/${assetID}/`, { headers: { Authorization: token }})
      .then(this.getData)
  }

  static getAssetByVulnerability (vulnerabilityID: number, token: string) {
    return this.Http
      .get<Asset.ByVulnerability>(`/api/assets/?vulnerability=${vulnerabilityID}`, { headers: { Authorization: token }})
      .then(this.getData)
  }
}


export default AssetService