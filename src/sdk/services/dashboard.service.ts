import { Dashboard } from "../@types/Dashboard";
import Service from "../Service";


class DashboardService extends Service {
  static getAssetCard (token: string) {
    return this.Http
      .get<Dashboard.CardAsset>('/api/dashboard/cards/asset', 
        { headers: { Authorization: token }})
      .then(this.getData)
  }

  static getVulnerabilityCard (token:string) {
    return this.Http
      .get<Dashboard.CardVulnerability>('/api/dashboard/cards/vulnerability', 
        { headers: { Authorization: token }})
      .then(this.getData)
  }

  static getRiskCard (token: string) {
    return this.Http
      .get<Dashboard.CardRisk>('/api/dashboard/cards/risk', 
        { headers: { Authorization: token}})
      .then(this.getData)
  }

  static getSeverityChart (token: string) {
    return this.Http
      .get<Dashboard.ChartSeverity>('/api/dashboard/charts/severity', 
        { headers: { Authorization: token }})
      .then(this.getData)
  }

  static getTopAssets (token: string) {
    return this.Http
      .get<Dashboard.ChartAssets[]>('/api/dashboard/charts/top-assets', 
      { headers: { Authorization: token }})
      .then(this.getData)
  }


}

export default DashboardService