import { useEffect, useState } from 'react'
import Button from '../../components/Button/Button'
import Input from '../../components/Input/Input'
import LoginService from '../../sdk/services/Login.service';
import * as L from './Login.styles'



export default function Login () {

  const [user, setUser] = useState({username:'', password:''});
  // const [error, setError] = useState('');

  const [token, setToken] = useState("")

  function handleFormSubmit (e: React.FormEvent<HTMLFormElement>) {
    e.preventDefault();

    const userdata = {
          "username": user.username,
          "password": user.password,
    };

    LoginService
      .getToken(userdata)
      .then(response => {
        const USER_TOKEN = `Token ${response.data.token}`
        localStorage.setItem('userToken', USER_TOKEN )
      })
      
      console.log(localStorage.getItem('userToken'))
  }

  // useEffect(() => {
  //   localStorage.setItem('userToken', token )
  // }, [token]);
  

  

  return <L.Wrapper>
    <L.Title>Login</L.Title>
    <L.Form onSubmit={handleFormSubmit}>
      <Input label='UsuÃ¡rio' placeholder='cvictorlima' onChange={e=> setUser ({...user, username: e.target.value})} value={user.username} />
      <Input label='Senha' placeholder='**********' type='password' onChange={e=> setUser ({...user, password: e.target.value})} value={user.password} />
      <Button variant='primary' label='LOGIN'  type='submit'/>
    </L.Form>
  </L.Wrapper>
}